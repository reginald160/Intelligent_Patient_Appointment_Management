@using HMS.Infrastructure.Persistence.DataContext
@using HMSPortal.Application.Core
@using HMSPortal.Application.Core.Cache
@using HMSPortal.Application.Core.Extensions
@using HMSPortal.Domain.Models
@using Microsoft.AspNetCore.Identity
@using Microsoft.Extensions.Caching.Memory
@using Newtonsoft.Json
@inject UserManager<ApplicationUser> UserManager
@inject SignInManager<ApplicationUser> SignInManager
@inject   IHttpContextAccessor _httpContextAccessor;
@inject  IMemoryCache _memoryCache;

@{
	var cacheKey = CoreValiables.LoginUser;
	var userCache = new CacheUserModel();

	var userCacheString = _httpContextAccessor.HttpContext.Session.GetString(cacheKey);

	if (string.IsNullOrEmpty(userCacheString))
	{
		var user = _httpContextAccessor.HttpContext.User;
		if (user.Identity.IsAuthenticated)
		{
			var currentUser = await UserManager.GetUserAsync(user);
			if (currentUser != null)
			{
				userCache = new CacheUserModel
						{
							Id = currentUser.Id,
							Email = currentUser.Email
						};

			}
		}
		else
		{
			var currentUser = UserManager.Users.FirstOrDefault(x => x.Email == "ozougwuifeanyi160@gmail.com");
			if (currentUser != null)
			{
				userCache = new CacheUserModel
						{
							Id = currentUser.Id,
							Email = currentUser.Email
						};

			}
		}

		// Serialize userCache to a JSON string
		var userCacheString1 = JsonConvert.SerializeObject(userCache);
		// Store userCacheString in session
		_httpContextAccessor.HttpContext.Session.SetString(cacheKey, userCacheString1);

	}

}


<!DOCTYPE html>
<html lang="en">

<head>
	<base href="/" />
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ProClinic-Bootstrap4 Hospital Admin</title>
	<!-- Fav  Icon Link -->
	<link rel="shortcut icon" type="image/png" href="mediplus-lite/img/logo.png">
	<!-- Bootstrap core CSS -->
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<!-- themify icons CSS -->
	<link rel="stylesheet" href="css/themify-icons.css">
	<!-- Animations CSS -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Main CSS -->
	<link rel="stylesheet" href="css/styles.css">
	<link rel="stylesheet" href="css/red.css" id="style_theme">
	<link rel="stylesheet" href="css/responsive.css">
	<!-- morris charts -->
	<link rel="stylesheet" href="charts/css/morris.css">
	<!-- jvectormap -->
	<link rel="stylesheet" href="css/jquery-jvectormap.css">

	<script src="js/modernizr.min.js"></script>
	<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

</head>

<body>

	<div class="theme-settings" id="switcher">
		<span class="theme-click">
			<span class="ti-settings"></span>
		</span>
		<span class="theme-color theme-default" data-color="green"></span>
		<span class="theme-color theme-blue" data-color="blue"></span>
		<span class="theme-color theme-red theme-active" data-color="red"></span>
		<span class="theme-color theme-violet" data-color="blue"></span>
		<span class="theme-color theme-yellow" data-color="yellow"></span>
	</div>

	<div class="wrapper">
		<!-- Sidebar -->
		<nav id="sidebar" class="proclinic-bg">
			<div class="sidebar-header">
				<a asp-controller="Dashboard" asp-action="Index"><img src="mediplus-lite/img/logo.png" class="logo" alt="logo"></a>
			</div>
			<ul class="list-unstyled components">
				<li class="active">
					<a href="#nav-dashboard" data-toggle="collapse" aria-expanded="true">
						<span class="ti-home"></span> Home
					</a>
					
				</li>
				<li>
					<a href="#nav-patients" data-toggle="collapse" aria-expanded="false">
						<span class="ti-wheelchair"></span> Patients
					</a>
					<ul class="collapse list-unstyled" id="nav-patients">
						
							
						</li>
						<a asp-controller="Patient" asp-action="Add">Add Patient</a>
						</li>
						<li>
					        <a asp-controller="Patient" asp-action="Index">All Patients</a>
						</li>
	
						
					</ul>

				</li>
				
				<li>
					<a href="#nav-doctors" data-toggle="collapse" aria-expanded="false">
						<span class="ti-user"></span> Doctors
					</a>
					<ul class="collapse list-unstyled" id="nav-doctors">
						<li>
							<a asp-controller="Doctor" asp-action="Add">Add Doctor</a>
						</li>
						
						<li>
							<a asp-controller="Doctor" asp-action="Index">All Doctors</a>
						</li>
					
					</ul>
				</li>
				<li>
					<a href="#nav-appointment" data-toggle="collapse" aria-expanded="false">
						<span class="ti-pencil-alt"></span> Appointments
					</a>
					<ul class="collapse list-unstyled" id="nav-appointment">
						<li>
						<a asp-controller="Appointment" asp-action="Add">Add Appointment</a>
						</li>
						<li>
							<a href="appointments.html">All Appointments</a>
						</li>
						<li>
							<a href="about-appointment.html">Appointment Details</a>
						</li>
						<li>
							<a href="edit-appointment.html">Edit Appointment</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#nav-payment" data-toggle="collapse" aria-expanded="false">
						<span class="ti-money"></span> Payments
					</a>
					<ul class="collapse list-unstyled" id="nav-payment">
						@* <li>
							<a href="add-payment.html">Add Payment</a>
						</li> *@
					<li>
						<a asp-controller="Payment" asp-action="Upsert">Add Payment</a>
					</li>
					<li>
							<a asp-controller="Payment" asp-action="Index">All Payment</a>
						</li>
						
						@* <li>
							<a href="payments.html">All Payments</a>
						</li> *@
						@* <li>
							<a href="about-payment.html"></a>
						</li> *@
						<li>
						<a asp-controller="PaymentInvoice" asp-action="Detail">Payment Invoice</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#nav-rooms" data-toggle="collapse" aria-expanded="false">
						<span class="ti-key"></span> Room Allotments
					</a>
					<ul class="collapse list-unstyled" id="nav-rooms">
						<li>
							<a href="add-room.html">Add Room Allotment</a>
						</li>
						<li>
							<a href="rooms.html">All Rooms</a>
						</li>
						<li>
							<a href="edit-room.html">Edit Room Allotment</a>
						</li>
					</ul>
				</li>
				<li class="nav-level-one">
					<a href="#nav-uiKit" data-toggle="collapse" aria-expanded="false">
						<span class="ti-layout-tab"></span> UI Kit
					</a>
					<ul class="list-unstyled collapse" aria-expanded="true" id="nav-uiKit">
						<li>
							<a href="typography.html">Typography</a>
						</li>
						<li>
							<a href="buttons.html">Buttons</a>
						</li>
						<li>
							<a href="cards.html">Cards</a>
						</li>
						<li>
							<a href="tabs.html">Tabs</a>
						</li>
						<li>
							<a href="accordions.html">Accordions</a>
						</li>
						<li>
							<a href="modals.html">Modals</a>
						</li>
						<li>
							<a href="lists.html">Lists &amp; Media Object</a>
						</li>
						<li>
							<a href="grid.html">Grid</a>
						</li>
						<li>
							<a href="progress-bars.html">Progress Bars</a>
						</li>
						<li>
							<a href="notifications-alerts.html">Notifications &amp; Alerts</a>
						</li>
						<li>
							<a href="pagination.html">Pagination</a>
						</li>
						<li>
							<a href="carousel.html">Carousel</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="tables.html">
						<span class="ti-layout-menu-v"></span> Tables
					</a>
				</li>
				<li>
					<a href="#nav-charts" data-toggle="collapse" aria-expanded="false">
						<span class="ti-pie-chart"></span> Charts
					</a>
					<ul class="collapse list-unstyled" id="nav-charts">
						<li>
							<a href="charts-1.html">Morris</a>
						</li>
						<li>
							<a href="charts-2.html">Flot</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#nav-maps" data-toggle="collapse" aria-expanded="false">
						<span class="ti-location-pin"></span> Maps
					</a>
					<ul class="collapse list-unstyled" id="nav-maps">
						<li>
							<a href="map-1.html">Google Maps</a>
						</li>
						<li>
							<a href="map-2.html">Vector Maps</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="forms.html">
						<span class="ti-layout-media-overlay-alt-2"></span> Forms
					</a>
				</li>
				<li>
					<a href="#nav-icons" data-toggle="collapse" aria-expanded="false">
						<span class="ti-themify-favicon"></span> icons
					</a>
					<ul class="collapse list-unstyled" id="nav-icons">
						<li>
							<a href="font-awesome.html">Font Awesome </a>
						</li>
						<li>
							<a href="themify.html">Themify</a>
						</li>
					</ul>
				</li>
				<li>
					<a href="#nav-pages" data-toggle="collapse" aria-expanded="false">
						<span class="ti-file"></span> Other Pages
					</a>
					<ul class="collapse list-unstyled" id="nav-pages">
						<li>
							<a href="login.html">Login </a>
						</li>
						<li>
							<a href="sign-up.html">Sign Up</a>
						</li>
						<li>
							<a href="404.html">404</a>
						</li>
						<li>
							<a href="blank-page.html">Blank Page</a>
						</li>
						<li>
							<a href="pricing.html">Pricing</a>
						</li>
						<li>
							<a href="faq.html">FAQ</a>
						</li>
						<li>
							<a href="invoice.html">Invoice</a>
						</li>
						<li>
							<a href="blank-page.html">Coming Soon</a>
						</li>
					</ul>
				</li>
			</ul>
			<div class="nav-help animated fadeIn">
				<h5><span class="ti-comments"></span> Need Help</h5>
				<h6>
					<span class="ti-mobile"></span> +1 1234 567 890
				</h6>
				<h6>
					<span class="ti-email"></span> email@site.com
				</h6>
				<p class="copyright-text">Copy rights &copy; 2018</p>
			</div>
		</nav>
		<!-- /Sidebar -->
		<!-- Page Content -->
		<div id="content">
			<!-- Top Navigation -->
			<nav class="navbar navbar-default">
				<div class="container-fluid">
					<div class="responsive-logo">
						<a href="index.html"><img src="images/logo-dark.png" class="logo" alt="logo"></a>
					</div>
					<ul class="nav">
						<li class="nav-item">
							<span class="ti-menu" id="sidebarCollapse"></span>
						</li>
						<li class="nav-item">
							<span title="Fullscreen" class="ti-fullscreen fullscreen"></span>
						</li>
						<li class="nav-item">
							<a data-toggle="modal" data-target=".proclinic-modal-lg">
								<span class="ti-search"></span>
							</a>
							<div class="modal fade proclinic-modal-lg" tabindex="-1" role="dialog" aria-hidden="true">
								<div class="modal-dialog modal-lorvens">
									<div class="modal-content proclinic-box-shadow2">
										<div class="modal-header">
											<h5 class="modal-title">Search Patient/Doctor:</h5>
											<span class="ti-close" data-dismiss="modal" aria-label="Close">
											</span>
										</div>
										<div class="modal-body">
											<form>
												<div class="form-group">
													<input type="text" class="form-control" id="search-term" placeholder="Type text here">
													<button type="button" class="btn btn-lorvens proclinic-bg">
														<span class="ti-location-arrow"></span> Search
													</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
						</li>
						<li class="nav-item">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="ti-announcement"></span>
							</a>
							<div class="dropdown-menu proclinic-box-shadow2 notifications animated flipInY">
								<h5>Notifications</h5>
								<a class="dropdown-item" href="#">
									<span class="ti-wheelchair"></span> New Patient Added
								</a>
								<a class="dropdown-item" href="#">
									<span class="ti-money"></span> Patient payment done
								</a>
								<a class="dropdown-item" href="#">
									<span class="ti-time"></span>Patient Appointment booked
								</a>
								<a class="dropdown-item" href="#">
									<span class="ti-wheelchair"></span> New Patient Added
								</a>
							</div>
						</li>
						<li class="nav-item">
							<a class="dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">
								<span class="ti-user"></span>
							</a>
							<div class="dropdown-menu proclinic-box-shadow2 profile animated flipInY">
								@if (User != null && User.Identity.IsAuthenticated)
								{
									<h5> @User.Identity.Name!</h5>
								}

								<a class="dropdown-item" href="#">
									<span class="ti-settings"></span> Settings
								</a>
								<a class="dropdown-item" href="#">
									<span class="ti-help-alt"></span> Help
								</a>
								<a class="dropdown-item" href="#">
									<span class="ti-power-off"></span> Logout
								</a>
							</div>
						</li>
					</ul>

				</div>
			</nav>
			<div class="row no-margin-padding">
				<div class="col-md-6">
					<h3 class="block-title">@ViewData["Title"]</h3>
				</div>
				<div class="col-md-6">
					<ol class="breadcrumb">
						<li class="breadcrumb-item">
							<a asp-action="Index" asp-controller="Dashboard">
								<span class="ti-home"></span>
							</a>
						</li>
						<li class="breadcrumb-item">@Html.GetControllerDisplayName()</li>
						<li class="breadcrumb-item active">@ViewData["Title"]</li>
					</ol>
				</div>
			</div>
		

			@RenderBody()

		</div>
		<!-- /Page Content -->
	</div>
	<!-- Back to Top -->
	<!-- /Back to Top -->
	<!-- Jquery Library-->
	<script src="js/jquery-3.2.1.min.js"></script>
	<!-- Popper Library-->
	<script src="js/popper.min.js"></script>
	<!-- Bootstrap Library-->
	<script src="js/bootstrap.min.js"></script>
	<!-- morris charts -->
	<script src="charts/js/raphael-min.js"></script>
	<script src="charts/js/morris.min.js"></script>
	<script src="js/custom-morris.js"></script>
	<script src="js/modernizr.min.js"></script>

	<script>
		function reloadPage() {
			location.reload();
		}
	</script>

	<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
	<script src="js/custom.js"></script>
	<script src="//cdn.datatables.net/1.13.7/js/jquery.dataTables.min.js" asp-append-version="true"></script>
	<script src="https://cdn.tiny.cloud/1/d1fpkxihlzdu61yllazo0c9ehlxeuk04a3awulg82m1vo2b4/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
</body>
</html>
@RenderSection("Scripts", required: false)